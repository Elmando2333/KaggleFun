{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/weare2333/naive-bayes-algorithm-in-programming?scriptVersionId=180386022\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"510bf11b","metadata":{"papermill":{"duration":0.006206,"end_time":"2024-05-29T08:13:28.669809","exception":false,"start_time":"2024-05-29T08:13:28.663603","status":"completed"},"tags":[]},"source":["# 朴素贝叶斯编程实现"]},{"cell_type":"code","execution_count":1,"id":"b47f6472","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2024-05-29T08:13:28.683662Z","iopub.status.busy":"2024-05-29T08:13:28.682922Z","iopub.status.idle":"2024-05-29T08:13:29.779876Z","shell.execute_reply":"2024-05-29T08:13:29.77868Z"},"papermill":{"duration":1.106769,"end_time":"2024-05-29T08:13:29.782525","exception":false,"start_time":"2024-05-29T08:13:28.675756","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas\n","import numpy as np\n","emails=pandas.read_csv('../input/emails/emails.csv')"]},{"cell_type":"code","execution_count":2,"id":"156d71ba","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:29.795829Z","iopub.status.busy":"2024-05-29T08:13:29.795468Z","iopub.status.idle":"2024-05-29T08:13:29.816039Z","shell.execute_reply":"2024-05-29T08:13:29.814846Z"},"papermill":{"duration":0.029976,"end_time":"2024-05-29T08:13:29.818365","exception":false,"start_time":"2024-05-29T08:13:29.788389","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["<bound method NDFrame.head of                                                    text  spam\n","0     Subject: naturally irresistible your corporate...     1\n","1     Subject: the stock trading gunslinger  fanny i...     1\n","2     Subject: unbelievable new homes made easy  im ...     1\n","3     Subject: 4 color printing special  request add...     1\n","4     Subject: do not have money , get software cds ...     1\n","...                                                 ...   ...\n","5723  Subject: re : research and development charges...     0\n","5724  Subject: re : receipts from visit  jim ,  than...     0\n","5725  Subject: re : enron case study update  wow ! a...     0\n","5726  Subject: re : interest  david ,  please , call...     0\n","5727  Subject: news : aurora 5 . 2 update  aurora ve...     0\n","\n","[5728 rows x 2 columns]>"]},"execution_count":2,"metadata":{},"output_type":"execute_result"}],"source":["emails.head"]},{"cell_type":"code","execution_count":3,"id":"716fc8fb","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:29.83231Z","iopub.status.busy":"2024-05-29T08:13:29.831925Z","iopub.status.idle":"2024-05-29T08:13:29.837244Z","shell.execute_reply":"2024-05-29T08:13:29.835981Z"},"papermill":{"duration":0.015144,"end_time":"2024-05-29T08:13:29.839589","exception":false,"start_time":"2024-05-29T08:13:29.824445","status":"completed"},"tags":[]},"outputs":[],"source":["def process_email(text):\n","    text=text.lower()\n","    return list(set(text.split()))"]},{"cell_type":"code","execution_count":4,"id":"f5b1b579","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:29.853869Z","iopub.status.busy":"2024-05-29T08:13:29.852749Z","iopub.status.idle":"2024-05-29T08:13:30.207553Z","shell.execute_reply":"2024-05-29T08:13:30.206404Z"},"papermill":{"duration":0.364794,"end_time":"2024-05-29T08:13:30.210292","exception":false,"start_time":"2024-05-29T08:13:29.845498","status":"completed"},"tags":[]},"outputs":[],"source":["emails['words']=emails['text'].apply(process_email)"]},{"cell_type":"code","execution_count":5,"id":"27633a2c","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:30.224287Z","iopub.status.busy":"2024-05-29T08:13:30.223865Z","iopub.status.idle":"2024-05-29T08:13:30.231878Z","shell.execute_reply":"2024-05-29T08:13:30.230842Z"},"papermill":{"duration":0.017807,"end_time":"2024-05-29T08:13:30.234285","exception":false,"start_time":"2024-05-29T08:13:30.216478","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0.2388268156424581"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["sum(emails['spam'])/len(emails)"]},{"cell_type":"markdown","id":"47521601","metadata":{"papermill":{"duration":0.005781,"end_time":"2024-05-29T08:13:30.246234","exception":false,"start_time":"2024-05-29T08:13:30.240453","status":"completed"},"tags":[]},"source":["此为一无所知的情况下，电子邮件是垃圾邮件的概率"]},{"cell_type":"code","execution_count":6,"id":"14b8b188","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:30.260336Z","iopub.status.busy":"2024-05-29T08:13:30.259945Z","iopub.status.idle":"2024-05-29T08:13:35.543249Z","shell.execute_reply":"2024-05-29T08:13:35.542126Z"},"papermill":{"duration":5.29368,"end_time":"2024-05-29T08:13:35.546088","exception":false,"start_time":"2024-05-29T08:13:30.252408","status":"completed"},"tags":[]},"outputs":[],"source":["model={}\n","\n","for index, email in emails.iterrows():\n","    for word in email['words']:\n","        if word not in model:\n","            model[word]={'spam':1,'ham':1}\n","        if word in model:\n","            if email['spam']:\n","                model[word]['spam']+=1\n","            else:\n","                model[word]['ham']+=1"]},{"cell_type":"markdown","id":"a920d844","metadata":{"papermill":{"duration":0.005878,"end_time":"2024-05-29T08:13:35.559235","exception":false,"start_time":"2024-05-29T08:13:35.553357","status":"completed"},"tags":[]},"source":["这里的 spam 和 ham 都初始化为 1，而不是 0，这是一种拉普拉斯平滑（Laplace smoothing）技术，用于避免概率计算中的零概率问题。"]},{"cell_type":"code","execution_count":7,"id":"f9467c71","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.573475Z","iopub.status.busy":"2024-05-29T08:13:35.573085Z","iopub.status.idle":"2024-05-29T08:13:35.580384Z","shell.execute_reply":"2024-05-29T08:13:35.579053Z"},"papermill":{"duration":0.017366,"end_time":"2024-05-29T08:13:35.582757","exception":false,"start_time":"2024-05-29T08:13:35.565391","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["{'spam': 9, 'ham': 1}"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["model['lottery']"]},{"cell_type":"code","execution_count":8,"id":"05836ed5","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.596874Z","iopub.status.busy":"2024-05-29T08:13:35.596505Z","iopub.status.idle":"2024-05-29T08:13:35.60352Z","shell.execute_reply":"2024-05-29T08:13:35.60242Z"},"papermill":{"duration":0.01688,"end_time":"2024-05-29T08:13:35.60587","exception":false,"start_time":"2024-05-29T08:13:35.58899","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["{'spam': 39, 'ham': 42}"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["model['sale']"]},{"cell_type":"code","execution_count":9,"id":"22151d40","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.620914Z","iopub.status.busy":"2024-05-29T08:13:35.620162Z","iopub.status.idle":"2024-05-29T08:13:35.62857Z","shell.execute_reply":"2024-05-29T08:13:35.627446Z"},"papermill":{"duration":0.018437,"end_time":"2024-05-29T08:13:35.630848","exception":false,"start_time":"2024-05-29T08:13:35.612411","status":"completed"},"tags":[]},"outputs":[],"source":["def predict_naive_bayes(email):\n","    total=len(emails)\n","    num_spam=sum(emails['spam'])\n","    num_ham=total-num_spam\n","    \n","    email=email.lower()\n","    words=set(email.split())\n","    spams=[1.0]\n","    hams=[1.0]\n","    \n","    for word in words:\n","        if word in model:\n","            spams.append(model[word]['spam']/num_spam*total)\n","            hams.append(model[word]['ham']/num_ham*total)\n","        \n","    prod_spams=np.prod(spams)*num_spam\n","    prod_hams=np.prod(hams)*num_ham\n","    return prod_spams/(prod_spams+prod_hams)"]},{"cell_type":"code","execution_count":10,"id":"a31f5252","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.645627Z","iopub.status.busy":"2024-05-29T08:13:35.644912Z","iopub.status.idle":"2024-05-29T08:13:35.653146Z","shell.execute_reply":"2024-05-29T08:13:35.652146Z"},"papermill":{"duration":0.018194,"end_time":"2024-05-29T08:13:35.655497","exception":false,"start_time":"2024-05-29T08:13:35.637303","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0.0028155775565736996"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["predict_naive_bayes('I want to sale my watch,dear my friend john,do you like it?Meet me at school')"]},{"cell_type":"code","execution_count":11,"id":"f8f54a93","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.671493Z","iopub.status.busy":"2024-05-29T08:13:35.670715Z","iopub.status.idle":"2024-05-29T08:13:35.678786Z","shell.execute_reply":"2024-05-29T08:13:35.677718Z"},"papermill":{"duration":0.018096,"end_time":"2024-05-29T08:13:35.681187","exception":false,"start_time":"2024-05-29T08:13:35.663091","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0.999973472265966"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["predict_naive_bayes('buy cheap lottery easy money now')"]},{"cell_type":"code","execution_count":12,"id":"a645eb59","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.696635Z","iopub.status.busy":"2024-05-29T08:13:35.695949Z","iopub.status.idle":"2024-05-29T08:13:35.703831Z","shell.execute_reply":"2024-05-29T08:13:35.70277Z"},"papermill":{"duration":0.018129,"end_time":"2024-05-29T08:13:35.705982","exception":false,"start_time":"2024-05-29T08:13:35.687853","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0.45071019183592903"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["predict_naive_bayes('Fuck you! you break down my watch!you must keep it back to me!')"]},{"cell_type":"code","execution_count":13,"id":"e2e9e70d","metadata":{"execution":{"iopub.execute_input":"2024-05-29T08:13:35.721687Z","iopub.status.busy":"2024-05-29T08:13:35.72103Z","iopub.status.idle":"2024-05-29T08:13:35.728671Z","shell.execute_reply":"2024-05-29T08:13:35.727611Z"},"papermill":{"duration":0.01818,"end_time":"2024-05-29T08:13:35.730943","exception":false,"start_time":"2024-05-29T08:13:35.712763","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0.2388268156424581"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["predict_naive_bayes('abcdefgss')"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":5024326,"sourceId":8435527,"sourceType":"datasetVersion"}],"dockerImageVersionId":30698,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":10.524289,"end_time":"2024-05-29T08:13:36.258559","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-05-29T08:13:25.73427","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}